<div class="report-header-2">{{ 'Organisation' | trans }}</div>
{% if not readonly %}
    <script>
        var {{ type }}Organisations = {{ organisations | json_encode | raw }};

        function fill{{ type }}Organisation(id) {
            for(var key in {{ type }}Organisations[id]) {
                var element = document.querySelector("input[name='{{ type }}_" + key + "']");
                if(element != null) {
                    element.value = {{ type }}Organisations[id][key];
                } else {
                    element = document.querySelector("textarea[name='{{ type }}_" + key + "']");
                    if(element != null) {
                        element.value = {{ type }}Organisations[id][key];
                        window["fix{{ type }}_" + key + "textareaheight"]();
                    }
                }
            }
        }
    </script>
    <div class="form-subgroup">
        <div class="form-item">
            <label>{{ 'Name' | trans }}</label>
            <div class="flex">
                <select id="{{ type }}-id" name="{{ type }}_org_id" onchange="toggleCustomInput('{{ type }}-name', this.options[this.selectedIndex].value, this.options[this.selectedIndex].value === 'customOption'); fill{{  type }}Organisation(this.options[this.selectedIndex].value)" autocomplete="off">
                    <option></option>
                    {% for organisation in organisations %}
                        <option value="{{ organisation.id }}">{{ organisation.alias }}</option>
                    {% endfor %}
                    <option value="customOption"{% if prefilled_data[type ~ '_name'] is defined %} selected{% endif %}>{{ 'Other' | trans }}</option>
                    <input type="text" class="custom-input" id="{{ type }}-name" placeholder="{{ 'Fill in another name ...' | trans }}" name="{{ type }}_name"
                       {% if prefilled_data[type ~ '_name'] is defined %}value="{{ prefilled_data[type ~ '_name'] }}" {% else %}style="display: none;"{% endif %} autocomplete="off">
                </select>
                </div>
        </div>
        <div class="form-item">
            {% include 'textfield.html.twig' with { 'name': type ~ '_vat', 'label': 'VAT number' | trans } %}
        </div>
    </div>
{% else %}
    <div class="form-subgroup">
        <div class="form-item">
            {% include 'textfield.html.twig' with { 'name': type ~ '_name', 'label': 'Name' | trans } %}
        </div>
        <div class="form-item">
            {% include 'textfield.html.twig' with { 'name': type ~ '_vat', 'label': 'VAT number' | trans } %}
        </div>
    </div>
{% endif %}
<div class="form-subgroup">
    <div class="form-item">
        {% include 'textfield.html.twig' with { 'name': type ~ '_address', 'label': 'Address' | trans } %}
    </div>
    <div class="form-item">
        {% include 'textfield.html.twig' with { 'name': type ~ '_postal', 'label': 'Postal code' | trans } %}
    </div>
    <div class="form-item">
        {% include 'textfield.html.twig' with { 'name': type ~ '_city', 'label': 'City' | trans } %}
    </div>
    <div class="form-item">
        {% include 'textfield.html.twig' with { 'name': type ~ '_stateProvince', 'label': 'Province or state' | trans } %}
    </div>
    <div class="form-item">
        {% include 'textfield.html.twig' with { 'name': type ~ '_country', 'label': 'Country' | trans } %}
    </div>
</div>
<div class="form-subgroup">
    <div class="form-item">
        {% include 'textfield.html.twig' with { 'name': type ~ '_email', 'label': 'General e-mail address' | trans } %}
    </div>
    <div class="form-item">
        {% include 'textfield.html.twig' with { 'name': type ~ '_website', 'label': 'Website' | trans, 'is_url': true } %}
    </div>
    <div class="form-item">
        {% include 'textfield.html.twig' with { 'name': type ~ '_phone', 'label': 'Telephone' | trans } %}
    </div>
    <div class="form-item">
        {% include 'textfield.html.twig' with { 'name': type ~ '_mobile', 'label': 'Cell phone' | trans } %}
    </div>
</div>
<div class="form-subgroup">
    <div class="form-item">
        {% include 'textarea.html.twig' with { 'name': type ~ '_notes', 'label': 'Notes' | trans } %}
    </div>
</div>
